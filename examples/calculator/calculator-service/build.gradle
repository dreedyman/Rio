import org.apache.tools.ant.filters.ReplaceTokens

group = 'org.rioproject.examples.calculator'
description = 'Example :: Calculator Service Implementation'
dependencies {
    compile project(':examples:calculator:calculator-api')
    compile project(':rio-lib')
    testCompile project(':rio-test')
    testCompile group: 'junit', name: 'junit', version: '4.8.2'
    testCompile group: 'ch.qos.logback', name: 'logback-classic', version: '1.0.11'
    implementation group: 'org.codehaus.groovy', name: 'groovy-all', version: "${groovyVersion}"
}

test {
    dependsOn("opstring")
    systemProperty 'java.security.policy', policyAll
    systemProperty "rio.home", "${rootProject.projectDir.path}/distribution/build/rio-${version}"
}

task opstring(type: Copy) {
    from "${project.projectDir.path}/../src/main/opstring"
    into "${project.projectDir.path}/deploy"
    include "calculator.groovy"
    filter(ReplaceTokens, tokens: [version: project.version])
}